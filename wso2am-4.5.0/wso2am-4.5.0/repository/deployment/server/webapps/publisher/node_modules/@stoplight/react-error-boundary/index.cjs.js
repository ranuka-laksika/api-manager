"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react");class GenericReactErrorBoundaryError extends Error{constructor(r,e){super(),this.name="GenericReactErrorBoundaryError",this.message=r.message,this.componentStack=null===e?null:e.componentStack}toJSON(){return{name:this.name,message:this.message,stack:this.stack,componentStack:this.componentStack}}}function __rest(r,e){var t={};for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&e.indexOf(o)<0&&(t[o]=r[o]);if(null!=r&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(r);n<o.length;n++)e.indexOf(o[n])<0&&(t[o[n]]=r[o[n]])}return t}const refreshPage=()=>{window.location.reload()},FallbackComponent=({className:r,tryRecovering:e})=>React.createElement("div",{className:r},React.createElement("h2",null,"Gah. The component just crashed"),React.createElement("p",null,"You can try reloading component or refresh the page."),React.createElement("button",{onClick:e,type:"button"},"Reload component"),React.createElement("button",{onClick:refreshPage,type:"button"},"Refresh page")),ErrorBoundaryContext=React.createContext({reporter:console,FallbackComponent:FallbackComponent}),ErrorBoundaryProvider=r=>{var{children:e}=r,t=__rest(r,["children"]);return React.createElement(ErrorBoundaryContext.Provider,{value:t},e)};class ErrorBoundary extends React.PureComponent{constructor(){super(...arguments),this.state={error:null,componentStack:null},this.throwError=(r=>{this.setError(r),this.handleError(r,null)}),this.recover=(()=>{null!==this.state.error&&this.setError(null)})}componentDidUpdate(r){if(null!==this.state.error&&void 0!==this.props.recoverableProps&&Array.isArray(this.props.recoverableProps))for(const e of this.props.recoverableProps)if(r[e]!==this.props[e]){this.setError(null);break}}componentDidCatch(r,e){this.setError(r,e.componentStack),this.handleError(r,e)}handleError(r,e){const t=new GenericReactErrorBoundaryError(r,e);!1!==this.props.reportErrors&&this.context.reporter.error(t),"function"==typeof this.props.onError&&this.props.onError(t)}setError(r,e=null){this.setState({error:r,componentStack:e})}render(){const{props:{FallbackComponent:r=this.context.FallbackComponent||FallbackComponent,children:e},state:{error:t,componentStack:o}}=this;return null!==t?React.createElement(r,{error:t,componentStack:o,tryRecovering:this.recover}):e}}ErrorBoundary.contextType=ErrorBoundaryContext;const withErrorBoundary=(r,e)=>{const t=t=>{const o=React.createRef();return React.createElement(ErrorBoundary,Object.assign(Object.assign(Object.assign({},e),t),{ref:o}),React.createElement(r,Object.assign(Object.assign({},t),{boundaryRef:o})))},o=r.displayName||r.name;return t.displayName=o?`WithErrorBoundary(${o})`:"WithErrorBoundary",t};exports.ErrorBoundary=ErrorBoundary,exports.ErrorBoundaryContext=ErrorBoundaryContext,exports.ErrorBoundaryProvider=ErrorBoundaryProvider,exports.FallbackComponent=FallbackComponent,exports.withErrorBoundary=withErrorBoundary;
