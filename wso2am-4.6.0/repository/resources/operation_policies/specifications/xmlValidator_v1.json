{
  "category": "Mediation",
  "name": "xmlValidator",
  "version": "v1",
  "displayName": "XML Validator",
  "description": "This policy validates the request body of the XML message",
  "applicableFlows": [
    "request"
  ],
  "supportedGateways": [
    "Synapse"
  ],
  "supportedApiTypes": [
    "HTTP"
  ],
  "policyAttributes": [
    {
      "name": "dtdEnabled",
      "displayName": "DTD Enabled",
      "description": "Enable or disable Document Type Definition (DTD) processing",
      "validationRegex": "^(true|false)$",
      "type": "Boolean",
      "defaultValue": false,
      "required": false
    },
    {
      "name": "externalEntitiesEnabled",
      "displayName": "External Entities Enabled",
      "description": "Enable or disable external entity processing",
      "validationRegex": "^(true|false)$",
      "type": "Boolean",
      "defaultValue": true,
      "required": false
    },
    {
      "name": "maxXMLDepth",
      "displayName": "Max XML Depth",
      "description": "Maximum depth of the XML structure allowed",
      "validationRegex": "^\\d{1,3}$",
      "type": "Integer",
      "defaultValue": 100,
      "required": false
    },
    {
      "name": "maxElementCount",
      "displayName": "Max Element Count",
      "description": "Maximum number of elements allowed in the XML payload",
      "validationRegex": "^\\d{1,3}$",
      "type": "Integer",
      "defaultValue": 100,
      "required": false
    },
    {
      "name": "maxAttributeCount",
      "displayName": "Max Attribute Count",
      "description": "Maximum number of attributes allowed per element",
      "validationRegex": "^\\d{1,3}$",
      "type": "Integer",
      "defaultValue": 100,
      "required": false
    },
    {
      "name": "maxAttributeLength",
      "displayName": "Max Attribute Length",
      "description": "Maximum length of an attribute value",
      "validationRegex": "^\\d{1,3}$",
      "type": "Integer",
      "defaultValue": 100,
      "required": false
    },
    {
      "name": "maxChildrenPerElement",
      "displayName": "Max Children Per Element",
      "description": "Maximum number of child elements allowed per element",
      "validationRegex": "^\\d{1,3}$",
      "type": "Integer",
      "defaultValue": 100,
      "required": false
    },
    {
      "name": "entityExpansionLimit",
      "displayName": "Entity Expansion Limit",
      "description": "Maximum number of entity expansions allowed",
      "validationRegex": "^\\d{1,3}$",
      "type": "Integer",
      "defaultValue": 100,
      "required": false
    },
    {
      "name": "requestMessageBufferSize",
      "displayName": "Request Message Buffer Size",
      "description": "Request message buffer size",
      "validationRegex": "^\\d{1,4}$",
      "type": "Integer",
      "defaultValue": 1024,
      "required": false
    },
    {
      "name": "xmlSchemaValidator",
      "displayName": "XML Schema Validator",
      "description": "XML schema validator implementation class",
      "validationRegex": "^([a-zA-Z_$][a-zA-Z\\d_$.]*)$",
      "type": "String",
      "defaultValue": "org.wso2.carbon.apimgt.gateway.mediators.XMLSchemaValidator",
      "required": false
    }
  ]
}